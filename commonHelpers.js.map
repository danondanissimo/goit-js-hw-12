{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst searchForm = document.querySelector('.js-search-form');\nconst photoContainer = document.querySelector('.js-photo-container');\nconst loadMore = document.querySelector('.js-load-more');\nconst loader = document.querySelector('.loader');\n\nlet currentPage = 1;\n\nlet defaultPageSize = 15;\n\nlet currentQuery = '';\n\nlet totalResult = 0;\n\nfunction photoTemplate(photo) {\n  return photo.hits\n    .map(\n      photo => `<li class=\"gallery-item\"><a class=\"gallery-link\" href=\"${photo.largeImageURL}\">\n    <img\n      src=\"${photo.webformatURL}\"\n      data-source=\"${photo.largeImageURL}\"\n      alt=\"${photo.tags}\"\n      class=\"gallery-image\"\n      \n    /></a>  \n\n  <div class=\"image-stats-block\">\n<ul class=\"image-stats-list\">\n  <li class=\"image-stats-item\"><p class=\"image-stats-text\">Likes:<br><span class=\"image-stats-value\">${photo.likes}</span></p>\n</li>\n<li class=\"image-stats-item\">\n  <p class=\"image-stats-text\">Views:<br><span class=\"image-stats-value\">${photo.views}</span></p>\n</li>\n<li class=\"image-stats-item\">\n  <p class=\"image-stats-text\">Comments:<br><span class=\"image-stats-value\">${photo.comments}</span></p>\n</li>\n<li class=\"image-stats-item\">\n  <p class=\"image-stats-text\">Downloads:<br><span class=\"image-stats-value\">${photo.downloads}</span></p>\n</li>\n</ul>\n  </div></li>`\n    )\n    .join('');\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction renderPhoto(photo) {\n  if (photo.hits.length === 0) {\n    iziToast.show({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      closeOnClick: true,\n      closeOnEscape: true,\n    });\n  } else {\n    totalResult = photo.total;\n    const markup = photoTemplate(photo);\n    photoContainer.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n  }\n}\n\n// ====================================================================\n\nsearchForm.addEventListener('submit', async e => {\n  e.preventDefault();\n  currentPage = 1;\n  photoContainer.replaceChildren();\n  currentQuery = e.target.elements.query.value.trim();\n  if (currentQuery.length === 0) {\n    iziToast.show({\n      message: 'Search field cannot be empty!',\n      closeOnClick: true,\n      closeOnEscape: true,\n    });\n  } else {\n    loader.style.display = 'block';\n    const data = await searchPhoto(currentQuery);\n\n    renderPhoto(data);\n    loader.style.display = 'none';\n\n    e.target.reset();\n    checkButtonStatus();\n  }\n});\n\nloadMore.addEventListener('click', async () => {\n  currentPage += 1;\n  loader.style.display = 'block';\n  const data = await searchPhoto(currentQuery);\n\n  renderPhoto(data);\n  loader.style.display = 'none';\n\n  const itemHeight = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect().height;\n\n  const scrollHeightCorrecter = itemHeight * 2 + 48;\n  console.log(scrollHeightCorrecter);\n\n  checkButtonStatus();\n  window.scrollBy({\n    top: scrollHeightCorrecter,\n    behavior: 'smooth',\n  });\n});\n\nfunction searchPhoto(searchedImage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const PARAMS = `?key=42185111-4f5cd61d4ffab1c12875fcbb6&q=${searchedImage}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${defaultPageSize}`;\n  const url = BASE_URL + PARAMS;\n\n  return axios.get(url).then(res => {\n    if (res.data.hits.length === 0) {\n      throw new Error(res.status);\n    } else {\n      return res.data;\n    }\n  });\n}\n\nfunction checkButtonStatus() {\n  // const maxPage = Math.ceil(totalResult / defaultPageSize);\n  const maxPage = 2;\n  if (maxPage <= currentPage) {\n    loadMore.classList.add('hidden');\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      closeOnClick: true,\n      closeOnEscape: true,\n    });\n  } else {\n    loadMore.classList.remove('hidden');\n  }\n}\n"],"names":["searchForm","photoContainer","loadMore","loader","currentPage","defaultPageSize","currentQuery","photoTemplate","photo","lightbox","SimpleLightbox","renderPhoto","iziToast","markup","e","data","searchPhoto","checkButtonStatus","scrollHeightCorrecter","searchedImage","BASE_URL","PARAMS","url","axios","res"],"mappings":"owBAYA,MAAMA,EAAa,SAAS,cAAc,iBAAiB,EACrDC,EAAiB,SAAS,cAAc,qBAAqB,EAC7DC,EAAW,SAAS,cAAc,eAAe,EACjDC,EAAS,SAAS,cAAc,SAAS,EAE/C,IAAIC,EAAc,EAEdC,EAAkB,GAElBC,EAAe,GAInB,SAASC,EAAcC,EAAO,CAC5B,OAAOA,EAAM,KACV,IACCA,GAAS,0DAA0DA,EAAM,aAAa;AAAA;AAAA,aAE/EA,EAAM,YAAY;AAAA,qBACVA,EAAM,aAAa;AAAA,aAC3BA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uGAOgFA,EAAM,KAAK;AAAA;AAAA;AAAA,0EAGxCA,EAAM,KAAK;AAAA;AAAA;AAAA,6EAGRA,EAAM,QAAQ;AAAA;AAAA;AAAA,8EAGbA,EAAM,SAAS;AAAA;AAAA;AAAA,cAIxF,EACA,KAAK,EAAE,CACZ,CAEA,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,SAASC,EAAYH,EAAO,CAC1B,GAAIA,EAAM,KAAK,SAAW,EACxBI,EAAS,KAAK,CACZ,QACE,2EACF,aAAc,GACd,cAAe,EACrB,CAAK,MACI,CACSJ,EAAM,MACpB,MAAMK,EAASN,EAAcC,CAAK,EAClCP,EAAe,mBAAmB,YAAaY,CAAM,EACrDJ,EAAS,QAAO,CACjB,CACH,CAIAT,EAAW,iBAAiB,SAAU,MAAMc,GAAK,CAK/C,GAJAA,EAAE,eAAc,EAChBV,EAAc,EACdH,EAAe,gBAAe,EAC9BK,EAAeQ,EAAE,OAAO,SAAS,MAAM,MAAM,OACzCR,EAAa,SAAW,EAC1BM,EAAS,KAAK,CACZ,QAAS,gCACT,aAAc,GACd,cAAe,EACrB,CAAK,MACI,CACLT,EAAO,MAAM,QAAU,QACvB,MAAMY,EAAO,MAAMC,EAAYV,CAAY,EAE3CK,EAAYI,CAAI,EAChBZ,EAAO,MAAM,QAAU,OAEvBW,EAAE,OAAO,QACTG,GACD,CACH,CAAC,EAEDf,EAAS,iBAAiB,QAAS,SAAY,CAC7CE,GAAe,EACfD,EAAO,MAAM,QAAU,QACvB,MAAMY,EAAO,MAAMC,EAAYV,CAAY,EAE3CK,EAAYI,CAAI,EAChBZ,EAAO,MAAM,QAAU,OAMvB,MAAMe,EAJa,SAChB,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAEgB,EAAI,GAC/C,QAAQ,IAAIA,CAAqB,EAEjCD,IACA,OAAO,SAAS,CACd,IAAKC,EACL,SAAU,QACd,CAAG,CACH,CAAC,EAED,SAASF,EAAYG,EAAe,CAClC,MAAMC,EAAW,2BACXC,EAAS,6CAA6CF,CAAa,iEAAiEf,CAAW,aAAaC,CAAe,GAC3KiB,EAAMF,EAAWC,EAEvB,OAAOE,EAAM,IAAID,CAAG,EAAE,KAAKE,GAAO,CAChC,GAAIA,EAAI,KAAK,KAAK,SAAW,EAC3B,MAAM,IAAI,MAAMA,EAAI,MAAM,EAE1B,OAAOA,EAAI,IAEjB,CAAG,CACH,CAEA,SAASP,GAAoB,CAGvB,GAAWb,GACbF,EAAS,UAAU,IAAI,QAAQ,EAC/BU,EAAS,KAAK,CACZ,QAAS,6DACT,aAAc,GACd,cAAe,EACrB,CAAK,GAEDV,EAAS,UAAU,OAAO,QAAQ,CAEtC"}